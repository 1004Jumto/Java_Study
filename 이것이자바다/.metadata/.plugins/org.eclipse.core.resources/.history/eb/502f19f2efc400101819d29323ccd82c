package ch20.oracle;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.Statement;

public class ConnectionEx {

	public static void main(String[] args) {
		Connection conn = null;
		try {
			Class.forName("oracle.jdbc.OracleDriver");
			
			conn = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521/xe","testuser", "test1234");
			System.out.println("연결 성공");
			
			
			String userid = "autumn";
			String username = "한가을";
			String userpassword = "12345";
			int userage = 23;
			String useremail = "autumn@mycompany.com";
			
			Statement stmt = conn.createStatement();
			String sql = "INSERT INTO users (userid, username, userpassword, userage, useremail)"
					+ "VALUES('" + userid + "', '" + username + "', '" + userpassword + "', '" + userage + "', '" + useremail + "')";
//			int result = stmt.executeUpdate(sql);		// 등록한 개수 리턴
			
			// prepared statement
			sql = "INSERT INTO users (userid, username, userpassword, userage, useremail)"
					+ "VALUES(?,?,?,?,?)";
			PreparedStatement pstmt = conn.prepareStatement(sql);
			pstmt.setString(1,  userid);
			pstmt.setString(2, username);
			pstmt.setString(3, userpassword);
			pstmt.setInt(4, userage);
			pstmt.setString(5, useremail);
			int result = stmt.executeUpdate(sql);		// 등록한 개수 리턴
			
			
			if(result > 0) System.out.println("등록성공");
			else System.out.println("등록실패");
		}
		catch(Exception e) {e.printStackTrace();}
		finally {
			if(conn != null) {
				try {
					conn.close();
					System.out.println("연결 끊기");
				}
				catch(Exception e) {}
			}
		}
	}

}
