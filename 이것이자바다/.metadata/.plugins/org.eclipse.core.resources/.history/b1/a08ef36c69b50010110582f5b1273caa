package chOmok;

import java.util.Scanner;

public class Omok {

	public static void main(String[] args) {
		Scanner scan = new Scanner(System.in);

		// 사용자 이름을 입력받는다
		System.out.print("사용자1 이름을 입력하세요: ");
		Player user = new Player(scan.nextLine(), "O");

		System.out.print("사용자2 이름을 입력하세요: ");
		Player computer = new Player(scan.nextLine(), "X");
		Board board = new Board(19);

		// 게임 시작
		play(board, user, computer);
	}

	private static void play(Board board, Player user1, Player user2) {
		board.print();

		Scanner scanner = new Scanner(System.in);

		boolean isStop = false; // 게임 종료 flag

		int turn = 1; // 사용자 턴 구분 (1: user1 / 2: user2)
		int row, col; // 사용자 입력 좌표
		Player currentPlayer;

		// 오목 되면 프로그램 종료
		while (!isStop) {

			// 턴
			if (turn == 1)
				currentPlayer = user1;
			else
				currentPlayer = user2;

			// 1. 사용자 좌표 입력받음
			System.out.print(currentPlayer.name + "> ");
			row = scanner.nextInt();
			col = scanner.nextInt();

			// 2. 입력 좌표 유효한지 확인
			if (row > 18 || col > 18 || board.map[row][col] != ".") {
				System.out.println("해당 위치에는 돌을 둘 수 없습니다\n");
				continue;
			}

			// 입력 좌표를 보드에 반영
			board.map[row][col] = currentPlayer.stone;

			// 3. 오목 검사
			if (Ocheck(board, currentPlayer.stone, row, col)) {
				isStop = true;
				System.out.println(currentPlayer + " WIN!");
			} else {
				// 턴 바꾸기
				if (turn == 1)
					turn = 0;
				else
					turn = 1;
			}

			// 3. 보드 프린트
			board.print();
		}

		// 종료
		System.out.println("To be continued...");
	}

	private static boolean Ocheck(Board board, String stone, int x, int y) {
		int cnt = 0;
		
		for (int row = 0; row < board.size; row++) {
			if (board.map[row][y].equals(stone)) {
				cnt++;
				if (cnt == 5) return true;
				else cnt = 0;
			}
		}
		cnt = 0; // 초기화
		
		for (int col = 0; col < board.size; col++) {
			if (board.map[x][col].equals(stone)) {
				cnt++;
				if (cnt == 5) return true; 
				else cnt = 0;
			}
		}
		cnt = 0;
		
		for (int num = 0; num < board.size; num++) {
			if (board.map[num][num].equals(stone)) {
				cnt++;
				if (cnt == 5) return true; 
				else cnt = 0;
			}
		}
		cnt = 0;
		
		for (int num = 0; num < board.size; num++) {
			if (board.map[num][board.size - num].equals(stone)) {
				cnt++;
				if (cnt == 5) return true;
				else cnt = 0;
			}
		}

		return false;
	}

}
